CREATE SCHEMA cd;


create table cd.facilities(
    facid int primary key,
    name varchar(100) not null,
    membercost numeric not null,
    guestcost numeric not null,
    initialoutlay numeric not null,
    monthlymaintenance numeric not null
);
 
insert into cd.facilities(facid, name, membercost, guestcost, initialoutlay, monthlymaintenance) values(0, 'Tennis Court 1', 5, 25, 10000, 200);
insert into cd.facilities(facid, name, membercost, guestcost, initialoutlay, monthlymaintenance) values(1, 'Tennis Court 2', 5, 25, 8000, 200);
insert into cd.facilities(facid, name, membercost, guestcost, initialoutlay, monthlymaintenance) values(2, 'Badminton Court', 0, 15.5, 4000, 50);
insert into cd.facilities(facid, name, membercost, guestcost, initialoutlay, monthlymaintenance) values(3, 'Table Tennis', 10, 15, 30, 10);
insert into cd.facilities(facid, name, membercost, guestcost, initialoutlay, monthlymaintenance) values(4, 'Massage Room 1', 35, 80, 4000, 3000);
insert into cd.facilities(facid, name, membercost, guestcost, initialoutlay, monthlymaintenance) values(5, 'Massage Room 2', 35, 80, 4000, 3000);
insert into cd.facilities(facid, name, membercost, guestcost, initialoutlay, monthlymaintenance) values(6, 'Squash Court', 3.5, 17.5, 5000, 80);
insert into cd.facilities(facid, name, membercost, guestcost, initialoutlay, monthlymaintenance) values(7, 'Snooker Table', 0, 5, 450, 15);
insert into cd.facilities(facid, name, membercost, guestcost, initialoutlay, monthlymaintenance) values(8, 'Pool Table', 10, 15, 40, 15);




create table cd.bookings(
    facid int references cd.facilities(facid),
    memid int not null,
    slots int not null
);


insert into cd.bookings(facid, memid, slots) values(3, 1, 2);
insert into cd.bookings(facid, memid, slots) values(4, 1, 2);
insert into cd.bookings(facid, memid, slots) values(6, 0, 2);
insert into cd.bookings(facid, memid, slots) values(7, 1, 2);
insert into cd.bookings(facid, memid, slots) values(8, 1, 1);
insert into cd.bookings(facid, memid, slots) values(8, 1, 1);
insert into cd.bookings(facid, memid, slots) values(0, 2, 3);
insert into cd.bookings(facid, memid, slots) values(0, 2, 3);
insert into cd.bookings(facid, memid, slots) values(4, 3, 2);
insert into cd.bookings(facid, memid, slots) values(4, 0, 200);
insert into cd.bookings(facid, memid, slots) values(4, 0, 200);
insert into cd.bookings(facid, memid, slots) values(6, 0, 2);
insert into cd.bookings(facid, memid, slots) values(6, 0, 2);
insert into cd.bookings(facid, memid, slots) values(6, 1, 2);
insert into cd.bookings(facid, memid, slots) values(7, 2, 2);
insert into cd.bookings(facid, memid, slots) values(8, 2, 900);
insert into cd.bookings(facid, memid, slots) values(8, 3, 1);
insert into cd.bookings(facid, memid, slots) values(1, 0, 3);
insert into cd.bookings(facid, memid, slots) values(2, 1, 3);
insert into cd.bookings(facid, memid, slots) values(3, 3, 2);
insert into cd.bookings(facid, memid, slots) values(3, 1, 2);
insert into cd.bookings(facid, memid, slots) values(4, 3, 2);
insert into cd.bookings(facid, memid, slots) values(6, 0, 2);
insert into cd.bookings(facid, memid, slots) values(6, 1, 2);
insert into cd.bookings(facid, memid, slots) values(8, 3, 1000);
insert into cd.bookings(facid, memid, slots) values(8, 3, 5000);
insert into cd.bookings(facid, memid, slots) values(7, 2, 2);
insert into cd.bookings(facid, memid, slots) values(3, 3, 1000);
insert into cd.bookings(facid, memid, slots) values(3, 3, 5000);
insert into cd.bookings(facid, memid, slots) values(8, 3, 1);
insert into cd.bookings(facid, memid, slots) values(0, 0, 3);
insert into cd.bookings(facid, memid, slots) values(0, 0, 3);
insert into cd.bookings(facid, memid, slots) values(0, 2, 3);
insert into cd.bookings(facid, memid, slots) values(2, 1, 3);
insert into cd.bookings(facid, memid, slots) values(3, 1, 2);
insert into cd.bookings(facid, memid, slots) values(4, 3, 2);
insert into cd.bookings(facid, memid, slots) values(6, 1, 2);
insert into cd.bookings(facid, memid, slots) values(7, 2, 2);
insert into cd.bookings(facid, memid, slots) values(7, 2, 2);
insert into cd.bookings(facid, memid, slots) values(8, 3, 1);
insert into cd.bookings(facid, memid, slots) values(0, 2, 3);
insert into cd.bookings(facid, memid, slots) values(0, 0, 3);
insert into cd.bookings(facid, memid, slots) values(0, 2, 3);
insert into cd.bookings(facid, memid, slots) values(1, 3, 3);
insert into cd.bookings(facid, memid, slots) values(2, 1, 3);
insert into cd.bookings(facid, memid, slots) values(2, 1, 3);
insert into cd.bookings(facid, memid, slots) values(2, 1, 3);
insert into cd.bookings(facid, memid, slots) values(3, 2, 2);
insert into cd.bookings(facid, memid, slots) values(4, 3, 2);
insert into cd.bookings(facid, memid, slots) values(4, 3, 2);
insert into cd.bookings(facid, memid, slots) values(4, 0, 2);
insert into cd.bookings(facid, memid, slots) values(6, 0, 2);
insert into cd.bookings(facid, memid, slots) values(6, 1, 2);
insert into cd.bookings(facid, memid, slots) values(6, 1, 2);
insert into cd.bookings(facid, memid, slots) values(6, 0, 2);
insert into cd.bookings(facid, memid, slots) values(7, 2, 2);
insert into cd.bookings(facid, memid, slots) values(8, 3, 1);
insert into cd.bookings(facid, memid, slots) values(8, 3, 2);
insert into cd.bookings(facid, memid, slots) values(0, 3, 3);
insert into cd.bookings(facid, memid, slots) values(0, 2, 3);
insert into cd.bookings(facid, memid, slots) values(1, 1, 3);
insert into cd.bookings(facid, memid, slots) values(1, 1, 3);
insert into cd.bookings(facid, memid, slots) values(3, 1, 9000);
insert into cd.bookings(facid, memid, slots) values(3, 3, 200);
insert into cd.bookings(facid, memid, slots) values(3, 1, 2);
insert into cd.bookings(facid, memid, slots) values(4, 0, 2);
insert into cd.bookings(facid, memid, slots) values(4, 2, 2);
insert into cd.bookings(facid, memid, slots) values(4, 0, 2);
insert into cd.bookings(facid, memid, slots) values(4, 0, 2);
insert into cd.bookings(facid, memid, slots) values(6, 0, 2);
insert into cd.bookings(facid, memid, slots) values(6, 0, 2);
insert into cd.bookings(facid, memid, slots) values(7, 2, 2);
insert into cd.bookings(facid, memid, slots) values(7, 1, 2);
insert into cd.bookings(facid, memid, slots) values(8, 3, 1000);
insert into cd.bookings(facid, memid, slots) values(8, 3, 5000);
insert into cd.bookings(facid, memid, slots) values(0, 2, 3);
insert into cd.bookings(facid, memid, slots) values(0, 2, 3);
insert into cd.bookings(facid, memid, slots) values(0, 2, 3);
insert into cd.bookings(facid, memid, slots) values(1, 0, 3);
insert into cd.bookings(facid, memid, slots) values(1, 1, 3);
insert into cd.bookings(facid, memid, slots) values(2, 1, 6);
insert into cd.bookings(facid, memid, slots) values(2, 0, 3);
insert into cd.bookings(facid, memid, slots) values(3, 3, 2);
insert into cd.bookings(facid, memid, slots) values(3, 3, 2);
insert into cd.bookings(facid, memid, slots) values(4, 2, 2);
insert into cd.bookings(facid, memid, slots) values(4, 3, 2);
insert into cd.bookings(facid, memid, slots) values(6, 0, 2);
insert into cd.bookings(facid, memid, slots) values(7, 1, 2);
insert into cd.bookings(facid, memid, slots) values(7, 0, 4);
insert into cd.bookings(facid, memid, slots) values(8, 3, 1);
insert into cd.bookings(facid, memid, slots) values(8, 3, 1);
insert into cd.bookings(facid, memid, slots) values(8, 3, 1);
insert into cd.bookings(facid, memid, slots) values(0, 0, 3);
insert into cd.bookings(facid, memid, slots) values(0, 0, 3);
insert into cd.bookings(facid, memid, slots) values(3, 2, 2);
insert into cd.bookings(facid, memid, slots) values(3, 1, 2);
insert into cd.bookings(facid, memid, slots) values(3, 3, 2);
insert into cd.bookings(facid, memid, slots) values(3, 2, 2);
insert into cd.bookings(facid, memid, slots) values(3, 1, 2);
insert into cd.bookings(facid, memid, slots) values(4, 0, 2);
insert into cd.bookings(facid, memid, slots) values(4, 4, 2);
insert into cd.bookings(facid, memid, slots) values(4, 0, 2);
insert into cd.bookings(facid, memid, slots) values(4, 3, 4);
insert into cd.bookings(facid, memid, slots) values(5, 0, 2);
insert into cd.bookings(facid, memid, slots) values(6, 0, 2);
insert into cd.bookings(facid, memid, slots) values(6, 0, 2);
insert into cd.bookings(facid, memid, slots) values(7, 4, 2);
insert into cd.bookings(facid, memid, slots) values(7, 2, 2);
insert into cd.bookings(facid, memid, slots) values(8, 0, 1);
insert into cd.bookings(facid, memid, slots) values(8, 3, 1);
insert into cd.bookings(facid, memid, slots) values(8, 3, 1);
insert into cd.bookings(facid, memid, slots) values(0, 4, 3);
insert into cd.bookings(facid, memid, slots) values(0, 2, 3);
insert into cd.bookings(facid, memid, slots) values(0, 0, 3);
insert into cd.bookings(facid, memid, slots) values(0, 0, 3);
insert into cd.bookings(facid, memid, slots) values(0, 2, 3);
insert into cd.bookings(facid, memid, slots) values(0, 2, 3);
insert into cd.bookings(facid, memid, slots) values(1, 0, 3);
insert into cd.bookings(facid, memid, slots) values(1, 0, 3);
insert into cd.bookings(facid, memid, slots) values(4, 1, 2);
insert into cd.bookings(facid, memid, slots) values(4, 0, 2);
insert into cd.bookings(facid, memid, slots) values(4, 3, 2);
insert into cd.bookings(facid, memid, slots) values(4, 0, 2);
insert into cd.bookings(facid, memid, slots) values(5, 4, 500);
insert into cd.bookings(facid, memid, slots) values(6, 0, 2);
insert into cd.bookings(facid, memid, slots) values(6, 0, 2);
insert into cd.bookings(facid, memid, slots) values(7, 0, 2);
insert into cd.bookings(facid, memid, slots) values(7, 0, 2);
insert into cd.bookings(facid, memid, slots) values(7, 0, 2);
insert into cd.bookings(facid, memid, slots) values(8, 4, 1000);
insert into cd.bookings(facid, memid, slots) values(8, 3, 1);
insert into cd.bookings(facid, memid, slots) values(0, 0, 3);
insert into cd.bookings(facid, memid, slots) values(0, 2, 3);
insert into cd.bookings(facid, memid, slots) values(1, 1, 3);
insert into cd.bookings(facid, memid, slots) values(2, 1, 3);
insert into cd.bookings(facid, memid, slots) values(2, 1, 3);
insert into cd.bookings(facid, memid, slots) values(3, 3, 2);
insert into cd.bookings(facid, memid, slots) values(4, 1, 2);
insert into cd.bookings(facid, memid, slots) values(7, 2, 2);
insert into cd.bookings(facid, memid, slots) values(3, 3, 1000);
insert into cd.bookings(facid, memid, slots) values(3, 3, 5000);
insert into cd.bookings(facid, memid, slots) values(6, 0, 4);
insert into cd.bookings(facid, memid, slots) values(7, 2, 2);
insert into cd.bookings(facid, memid, slots) values(7, 4, 2);
insert into cd.bookings(facid, memid, slots) values(7, 4, 2);
insert into cd.bookings(facid, memid, slots) values(8, 3, 1);
insert into cd.bookings(facid, memid, slots) values(0, 2, 3);
insert into cd.bookings(facid, memid, slots) values(0, 4, 3);
insert into cd.bookings(facid, memid, slots) values(0, 3, 3);
insert into cd.bookings(facid, memid, slots) values(1, 1, 3);
insert into cd.bookings(facid, memid, slots) values(2, 1, 3);
insert into cd.bookings(facid, memid, slots) values(2, 0, 3);
insert into cd.bookings(facid, memid, slots) values(2, 1, 3);
insert into cd.bookings(facid, memid, slots) values(4, 0, 2);
insert into cd.bookings(facid, memid, slots) values(4, 0, 2);
insert into cd.bookings(facid, memid, slots) values(4, 0, 2);
insert into cd.bookings(facid, memid, slots) values(4, 3, 2);
insert into cd.bookings(facid, memid, slots) values(4, 4, 2);
insert into cd.bookings(facid, memid, slots) values(6, 0, 2);
insert into cd.bookings(facid, memid, slots) values(7, 0, 2);
insert into cd.bookings(facid, memid, slots) values(7, 1, 2);
insert into cd.bookings(facid, memid, slots) values(7, 4, 2);
insert into cd.bookings(facid, memid, slots) values(8, 0, 1);
insert into cd.bookings(facid, memid, slots) values(8, 2, 1);
insert into cd.bookings(facid, memid, slots) values(0, 2, 3);
insert into cd.bookings(facid, memid, slots) values(0, 4, 3);
insert into cd.bookings(facid, memid, slots) values(0, 3, 3);
insert into cd.bookings(facid, memid, slots) values(1, 3, 3);
insert into cd.bookings(facid, memid, slots) values(1, 3, 3);
insert into cd.bookings(facid, memid, slots) values(1, 0, 3);
insert into cd.bookings(facid, memid, slots) values(2, 1, 3);
insert into cd.bookings(facid, memid, slots) values(3, 2, 2);
insert into cd.bookings(facid, memid, slots) values(4, 3, 2);
insert into cd.bookings(facid, memid, slots) values(4, 1, 2);
insert into cd.bookings(facid, memid, slots) values(6, 0, 2);
insert into cd.bookings(facid, memid, slots) values(6, 1, 2);
insert into cd.bookings(facid, memid, slots) values(6, 0, 2);
insert into cd.bookings(facid, memid, slots) values(7, 2, 2);
insert into cd.bookings(facid, memid, slots) values(7, 2, 2);
insert into cd.bookings(facid, memid, slots) values(7, 4, 2);
insert into cd.bookings(facid, memid, slots) values(7, 1, 2);
insert into cd.bookings(facid, memid, slots) values(8, 3, 500);
insert into cd.bookings(facid, memid, slots) values(8, 1, 900);
insert into cd.bookings(facid, memid, slots) values(0, 2, 3);
insert into cd.bookings(facid, memid, slots) values(0, 0, 3);
insert into cd.bookings(facid, memid, slots) values(0, 2, 3);
insert into cd.bookings(facid, memid, slots) values(1, 0, 3);
insert into cd.bookings(facid, memid, slots) values(1, 0, 3);
insert into cd.bookings(facid, memid, slots) values(1, 3, 3);
insert into cd.bookings(facid, memid, slots) values(2, 1, 3);
insert into cd.bookings(facid, memid, slots) values(3, 1, 2);
insert into cd.bookings(facid, memid, slots) values(4, 3, 2);
insert into cd.bookings(facid, memid, slots) values(4, 0, 2);
insert into cd.bookings(facid, memid, slots) values(4, 3, 2);
insert into cd.bookings(facid, memid, slots) values(7, 4, 2);
insert into cd.bookings(facid, memid, slots) values(7, 4, 2);
insert into cd.bookings(facid, memid, slots) values(8, 4, 1);
insert into cd.bookings(facid, memid, slots) values(8, 2, 1);
insert into cd.bookings(facid, memid, slots) values(8, 3, 1);
insert into cd.bookings(facid, memid, slots) values(8, 3, 1);
insert into cd.bookings(facid, memid, slots) values(0, 5, 3);
insert into cd.bookings(facid, memid, slots) values(0, 5, 3);
insert into cd.bookings(facid, memid, slots) values(1, 1, 3);
insert into cd.bookings(facid, memid, slots) values(1, 0, 3);
insert into cd.bookings(facid, memid, slots) values(2, 1, 3);
insert into cd.bookings(facid, memid, slots) values(4, 3, 2);
insert into cd.bookings(facid, memid, slots) values(4, 1, 2);
insert into cd.bookings(facid, memid, slots) values(4, 3, 2);
insert into cd.bookings(facid, memid, slots) values(4, 3, 2);
insert into cd.bookings(facid, memid, slots) values(6, 0, 2);
insert into cd.bookings(facid, memid, slots) values(7, 4, 2);
insert into cd.bookings(facid, memid, slots) values(7, 2, 2);
insert into cd.bookings(facid, memid, slots) values(7, 4, 2);
insert into cd.bookings(facid, memid, slots) values(7, 5, 2);
insert into cd.bookings(facid, memid, slots) values(8, 4, 1);
insert into cd.bookings(facid, memid, slots) values(8, 1, 1);
insert into cd.bookings(facid, memid, slots) values(8, 4, 1);
insert into cd.bookings(facid, memid, slots) values(8, 3, 1);
insert into cd.bookings(facid, memid, slots) values(0, 5, 3);
insert into cd.bookings(facid, memid, slots) values(0, 5, 3);
insert into cd.bookings(facid, memid, slots) values(1, 1, 3);
insert into cd.bookings(facid, memid, slots) values(1, 4, 3);
insert into cd.bookings(facid, memid, slots) values(2, 5, 3);
insert into cd.bookings(facid, memid, slots) values(2, 1, 3);
insert into cd.bookings(facid, memid, slots) values(2, 1, 3);
insert into cd.bookings(facid, memid, slots) values(2, 2, 3);
insert into cd.bookings(facid, memid, slots) values(3, 1, 2);
insert into cd.bookings(facid, memid, slots) values(3, 2, 2);
insert into cd.bookings(facid, memid, slots) values(4, 0, 2);
insert into cd.bookings(facid, memid, slots) values(4, 3, 2);
insert into cd.bookings(facid, memid, slots) values(4, 3, 2);
insert into cd.bookings(facid, memid, slots) values(4, 5, 2);
insert into cd.bookings(facid, memid, slots) values(4, 3, 2);
insert into cd.bookings(facid, memid, slots) values(5, 0, 2);
insert into cd.bookings(facid, memid, slots) values(6, 4, 2);
insert into cd.bookings(facid, memid, slots) values(6, 0, 2);
insert into cd.bookings(facid, memid, slots) values(7, 4, 2);
insert into cd.bookings(facid, memid, slots) values(7, 5, 2);
insert into cd.bookings(facid, memid, slots) values(7, 4, 2);
insert into cd.bookings(facid, memid, slots) values(8, 3, 1);
insert into cd.bookings(facid, memid, slots) values(8, 2, 1);
insert into cd.bookings(facid, memid, slots) values(8, 3, 1);
insert into cd.bookings(facid, memid, slots) values(8, 3, 1);
insert into cd.bookings(facid, memid, slots) values(8, 0, 1);
insert into cd.bookings(facid, memid, slots) values(8, 3, 1);
insert into cd.bookings(facid, memid, slots) values(8, 3, 1);
insert into cd.bookings(facid, memid, slots) values(8, 3, 1);
insert into cd.bookings(facid, memid, slots) values(0, 5, 3);
insert into cd.bookings(facid, memid, slots) values(0, 5, 3);
insert into cd.bookings(facid, memid, slots) values(1, 0, 3);
insert into cd.bookings(facid, memid, slots) values(1, 0, 3);
insert into cd.bookings(facid, memid, slots) values(2, 1, 3);
insert into cd.bookings(facid, memid, slots) values(3, 2, 2);
insert into cd.bookings(facid, memid, slots) values(3, 3, 2);
insert into cd.bookings(facid, memid, slots) values(4, 1, 2);
insert into cd.bookings(facid, memid, slots) values(7, 2, 2);
insert into cd.bookings(facid, memid, slots) values(3, 3, 1000);
insert into cd.bookings(facid, memid, slots) values(3, 3, 5000);
insert into cd.bookings(facid, memid, slots) values(4, 4, 2);
insert into cd.bookings(facid, memid, slots) values(4, 5, 2);
insert into cd.bookings(facid, memid, slots) values(5, 0, 2);
insert into cd.bookings(facid, memid, slots) values(6, 0, 2);
insert into cd.bookings(facid, memid, slots) values(6, 0, 2);
insert into cd.bookings(facid, memid, slots) values(6, 0, 2);
insert into cd.bookings(facid, memid, slots) values(6, 1, 2);
insert into cd.bookings(facid, memid, slots) values(7, 4, 2);
insert into cd.bookings(facid, memid, slots) values(7, 4, 2);
insert into cd.bookings(facid, memid, slots) values(8, 3, 1);
insert into cd.bookings(facid, memid, slots) values(8, 0, 1);
insert into cd.bookings(facid, memid, slots) values(8, 3, 1);
insert into cd.bookings(facid, memid, slots) values(8, 4, 1);
insert into cd.bookings(facid, memid, slots) values(8, 3, 1);
insert into cd.bookings(facid, memid, slots) values(8, 4, 1);
insert into cd.bookings(facid, memid, slots) values(0, 2, 3);
insert into cd.bookings(facid, memid, slots) values(0, 4, 3);
insert into cd.bookings(facid, memid, slots) values(0, 5, 3);
insert into cd.bookings(facid, memid, slots) values(8, 3, 1000);
insert into cd.bookings(facid, memid, slots) values(8, 3, 5000);
insert into cd.bookings(facid, memid, slots) values(0, 0, 3);
insert into cd.bookings(facid, memid, slots) values(0, 5, 3);
insert into cd.bookings(facid, memid, slots) values(1, 1, 3);
insert into cd.bookings(facid, memid, slots) values(1, 0, 3);
insert into cd.bookings(facid, memid, slots) values(1, 0, 3);
insert into cd.bookings(facid, memid, slots) values(2, 1, 3);
insert into cd.bookings(facid, memid, slots) values(2, 0, 3);
insert into cd.bookings(facid, memid, slots) values(2, 1, 3);
insert into cd.bookings(facid, memid, slots) values(2, 2, 3);
insert into cd.bookings(facid, memid, slots) values(3, 3, 2);
insert into cd.bookings(facid, memid, slots) values(3, 3, 2);
insert into cd.bookings(facid, memid, slots) values(3, 3, 2);
insert into cd.bookings(facid, memid, slots) values(4, 3, 2);
insert into cd.bookings(facid, memid, slots) values(4, 5, 2);
insert into cd.bookings(facid, memid, slots) values(4, 0, 2);
insert into cd.bookings(facid, memid, slots) values(4, 1, 2);
insert into cd.bookings(facid, memid, slots) values(4, 0, 2);
insert into cd.bookings(facid, memid, slots) values(5, 0, 2);
insert into cd.bookings(facid, memid, slots) values(6, 4, 2);
insert into cd.bookings(facid, memid, slots) values(6, 2, 2);
insert into cd.bookings(facid, memid, slots) values(6, 0, 2);
insert into cd.bookings(facid, memid, slots) values(6, 0, 2);
insert into cd.bookings(facid, memid, slots) values(7, 2, 2);
insert into cd.bookings(facid, memid, slots) values(7, 0, 2);
insert into cd.bookings(facid, memid, slots) values(7, 0, 2);
insert into cd.bookings(facid, memid, slots) values(7, 4, 4);
insert into cd.bookings(facid, memid, slots) values(8, 3, 1);
insert into cd.bookings(facid, memid, slots) values(8, 1, 1);
insert into cd.bookings(facid, memid, slots) values(8, 3, 1);
insert into cd.bookings(facid, memid, slots) values(8, 3, 1);
insert into cd.bookings(facid, memid, slots) values(7, 2, 2);
insert into cd.bookings(facid, memid, slots) values(3, 3, 1000);
insert into cd.bookings(facid, memid, slots) values(3, 3, 5000);
insert into cd.bookings(facid, memid, slots) values(8, 3, 1);
insert into cd.bookings(facid, memid, slots) values(0, 3, 3);
insert into cd.bookings(facid, memid, slots) values(0, 5, 3);
insert into cd.bookings(facid, memid, slots) values(0, 5, 3);
insert into cd.bookings(facid, memid, slots) values(0, 5, 3);
insert into cd.bookings(facid, memid, slots) values(0, 0, 3);
insert into cd.bookings(facid, memid, slots) values(1, 2, 3);
insert into cd.bookings(facid, memid, slots) values(1, 3, 3);
insert into cd.bookings(facid, memid, slots) values(1, 4, 3);
insert into cd.bookings(facid, memid, slots) values(2, 1, 3);
insert into cd.bookings(facid, memid, slots) values(3, 3, 2);
insert into cd.bookings(facid, memid, slots) values(3, 1, 2);
insert into cd.bookings(facid, memid, slots) values(4, 5, 2);
insert into cd.bookings(facid, memid, slots) values(4, 0, 2);
insert into cd.bookings(facid, memid, slots) values(4, 1, 2);
insert into cd.bookings(facid, memid, slots) values(4, 0, 2);
insert into cd.bookings(facid, memid, slots) values(4, 3, 2);
insert into cd.bookings(facid, memid, slots) values(6, 0, 2);
insert into cd.bookings(facid, memid, slots) values(6, 4, 2);
insert into cd.bookings(facid, memid, slots) values(6, 2, 2);
insert into cd.bookings(facid, memid, slots) values(6, 0, 4);
insert into cd.bookings(facid, memid, slots) values(7, 2, 2);
insert into cd.bookings(facid, memid, slots) values(7, 2, 2);
insert into cd.bookings(facid, memid, slots) values(7, 4, 2);
insert into cd.bookings(facid, memid, slots) values(8, 1, 1);
insert into cd.bookings(facid, memid, slots) values(8, 2, 1);
insert into cd.bookings(facid, memid, slots) values(8, 3, 1);
insert into cd.bookings(facid, memid, slots) values(0, 0, 3);
insert into cd.bookings(facid, memid, slots) values(0, 5, 3);
insert into cd.bookings(facid, memid, slots) values(0, 5, 3);
insert into cd.bookings(facid, memid, slots) values(0, 4, 3);
insert into cd.bookings(facid, memid, slots) values(1, 1, 3);
insert into cd.bookings(facid, memid, slots) values(1, 0, 3);
insert into cd.bookings(facid, memid, slots) values(2, 0, 3);
insert into cd.bookings(facid, memid, slots) values(2, 1, 3);
insert into cd.bookings(facid, memid, slots) values(3, 2, 2);
insert into cd.bookings(facid, memid, slots) values(4, 0, 2);
insert into cd.bookings(facid, memid, slots) values(4, 3, 2);
insert into cd.bookings(facid, memid, slots) values(4, 0, 4);
insert into cd.bookings(facid, memid, slots) values(4, 3, 2);
insert into cd.bookings(facid, memid, slots) values(4, 1, 2);
insert into cd.bookings(facid, memid, slots) values(4, 0, 2);
insert into cd.bookings(facid, memid, slots) values(6, 4, 2);
insert into cd.bookings(facid, memid, slots) values(6, 0, 2);
insert into cd.bookings(facid, memid, slots) values(6, 0, 2);
insert into cd.bookings(facid, memid, slots) values(8, 3, 1);
insert into cd.bookings(facid, memid, slots) values(8, 3, 1);
insert into cd.bookings(facid, memid, slots) values(8, 3, 2);
insert into cd.bookings(facid, memid, slots) values(8, 3, 1);
insert into cd.bookings(facid, memid, slots) values(0, 5, 3);
insert into cd.bookings(facid, memid, slots) values(0, 0, 3);
insert into cd.bookings(facid, memid, slots) values(0, 2, 3);
insert into cd.bookings(facid, memid, slots) values(1, 0, 3);
insert into cd.bookings(facid, memid, slots) values(1, 0, 3);
insert into cd.bookings(facid, memid, slots) values(1, 5, 3);
insert into cd.bookings(facid, memid, slots) values(2, 1, 3);
insert into cd.bookings(facid, memid, slots) values(2, 1, 3);
insert into cd.bookings(facid, memid, slots) values(2, 1, 3);
insert into cd.bookings(facid, memid, slots) values(3, 3, 2);
insert into cd.bookings(facid, memid, slots) values(3, 2, 2);
insert into cd.bookings(facid, memid, slots) values(4, 4, 2);
insert into cd.bookings(facid, memid, slots) values(4, 3, 2);
insert into cd.bookings(facid, memid, slots) values(4, 0, 2);
insert into cd.bookings(facid, memid, slots) values(4, 5, 2);
insert into cd.bookings(facid, memid, slots) values(4, 0, 2);
insert into cd.bookings(facid, memid, slots) values(4, 1, 2);
insert into cd.bookings(facid, memid, slots) values(4, 3, 2);
insert into cd.bookings(facid, memid, slots) values(6, 4, 4);
insert into cd.bookings(facid, memid, slots) values(6, 0, 2);
insert into cd.bookings(facid, memid, slots) values(6, 0, 2);
insert into cd.bookings(facid, memid, slots) values(7, 2, 2);
insert into cd.bookings(facid, memid, slots) values(7, 2, 2);
insert into cd.bookings(facid, memid, slots) values(8, 3, 1);
insert into cd.bookings(facid, memid, slots) values(8, 3, 1);
insert into cd.bookings(facid, memid, slots) values(8, 2, 1);
insert into cd.bookings(facid, memid, slots) values(0, 0, 3);
insert into cd.bookings(facid, memid, slots) values(7, 2, 2);
insert into cd.bookings(facid, memid, slots) values(3, 3, 1000);
insert into cd.bookings(facid, memid, slots) values(3, 3, 5000);
insert into cd.bookings(facid, memid, slots) values(0, 0, 3);
insert into cd.bookings(facid, memid, slots) values(0, 5, 3);
insert into cd.bookings(facid, memid, slots) values(1, 1, 3);
insert into cd.bookings(facid, memid, slots) values(1, 4, 3);
insert into cd.bookings(facid, memid, slots) values(1, 4, 3);
insert into cd.bookings(facid, memid, slots) values(1, 0, 3);
insert into cd.bookings(facid, memid, slots) values(1, 4, 3);
insert into cd.bookings(facid, memid, slots) values(2, 1, 3);
insert into cd.bookings(facid, memid, slots) values(2, 5, 3);
insert into cd.bookings(facid, memid, slots) values(2, 1, 3);
insert into cd.bookings(facid, memid, slots) values(2, 1, 3);
insert into cd.bookings(facid, memid, slots) values(3, 2, 2);
insert into cd.bookings(facid, memid, slots) values(3, 2, 2);
insert into cd.bookings(facid, memid, slots) values(4, 4, 2);
insert into cd.bookings(facid, memid, slots) values(4, 0, 2);
insert into cd.bookings(facid, memid, slots) values(4, 3, 2);
insert into cd.bookings(facid, memid, slots) values(5, 3, 2);
insert into cd.bookings(facid, memid, slots) values(6, 0, 2);
insert into cd.bookings(facid, memid, slots) values(6, 0, 4);
insert into cd.bookings(facid, memid, slots) values(6, 0, 2);
insert into cd.bookings(facid, memid, slots) values(7, 5, 2);
insert into cd.bookings(facid, memid, slots) values(7, 4, 2);
insert into cd.bookings(facid, memid, slots) values(8, 3, 3);
insert into cd.bookings(facid, memid, slots) values(8, 3, 1);
insert into cd.bookings(facid, memid, slots) values(8, 3, 2);
insert into cd.bookings(facid, memid, slots) values(8, 2, 1);
insert into cd.bookings(facid, memid, slots) values(0, 0, 3);
insert into cd.bookings(facid, memid, slots) values(0, 4, 3);
insert into cd.bookings(facid, memid, slots) values(0, 5, 3);
insert into cd.bookings(facid, memid, slots) values(1, 4, 3);
insert into cd.bookings(facid, memid, slots) values(1, 0, 6);
insert into cd.bookings(facid, memid, slots) values(1, 1, 3);
insert into cd.bookings(facid, memid, slots) values(2, 1, 3);
insert into cd.bookings(facid, memid, slots) values(2, 2, 3);
insert into cd.bookings(facid, memid, slots) values(3, 3, 2);
insert into cd.bookings(facid, memid, slots) values(3, 3, 2);
insert into cd.bookings(facid, memid, slots) values(4, 0, 2);
insert into cd.bookings(facid, memid, slots) values(4, 5, 2);
insert into cd.bookings(facid, memid, slots) values(4, 0, 2);
insert into cd.bookings(facid, memid, slots) values(4, 1, 2);
insert into cd.bookings(facid, memid, slots) values(4, 0, 2);
insert into cd.bookings(facid, memid, slots) values(4, 0, 2);
insert into cd.bookings(facid, memid, slots) values(4, 0, 2);
insert into cd.bookings(facid, memid, slots) values(5, 5, 2);
insert into cd.bookings(facid, memid, slots) values(6, 0, 2);
insert into cd.bookings(facid, memid, slots) values(6, 0, 2);
insert into cd.bookings(facid, memid, slots) values(7, 4, 2);
insert into cd.bookings(facid, memid, slots) values(7, 5, 2);
insert into cd.bookings(facid, memid, slots) values(7, 2, 2);
insert into cd.bookings(facid, memid, slots) values(7, 4, 2);
insert into cd.bookings(facid, memid, slots) values(7, 2, 2);
insert into cd.bookings(facid, memid, slots) values(8, 3, 1);
insert into cd.bookings(facid, memid, slots) values(8, 3, 2);
insert into cd.bookings(facid, memid, slots) values(8, 3, 1);
insert into cd.bookings(facid, memid, slots) values(8, 3, 1);
insert into cd.bookings(facid, memid, slots) values(8, 0, 1);
insert into cd.bookings(facid, memid, slots) values(8, 4, 1);
insert into cd.bookings(facid, memid, slots) values(8, 0, 1);
insert into cd.bookings(facid, memid, slots) values(0, 5, 3);
insert into cd.bookings(facid, memid, slots) values(0, 0, 3);
insert into cd.bookings(facid, memid, slots) values(0, 0, 3);
insert into cd.bookings(facid, memid, slots) values(1, 1, 3);
insert into cd.bookings(facid, memid, slots) values(1, 0, 3);
insert into cd.bookings(facid, memid, slots) values(1, 4, 3);
insert into cd.bookings(facid, memid, slots) values(2, 1, 3);
insert into cd.bookings(facid, memid, slots) values(2, 1, 3);
insert into cd.bookings(facid, memid, slots) values(8, 3, 1000);
insert into cd.bookings(facid, memid, slots) values(8, 3, 5000);
insert into cd.bookings(facid, memid, slots) values(3, 2, 2);
insert into cd.bookings(facid, memid, slots) values(3, 3, 4);
insert into cd.bookings(facid, memid, slots) values(3, 3, 2);
insert into cd.bookings(facid, memid, slots) values(3, 2, 2);

select  name, 
    initialoutlay / (monthlyrevenue - monthlymaintenance) as repaytime 
    from 
        (select name, 
            initialoutlay,
            monthlymaintenance,
            sum(case
                when memid = 0 then slots * guestcost
                else slots * membercost
            end)/3 as monthlyrevenue
        from cd.bookings bk
        join cd.facilities fc
            on bk.facid = fc.facid
        group by fc.facid
    ) as tb1
order by name;